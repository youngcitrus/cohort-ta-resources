(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{27:function(e,t,n){e.exports=n(40)},32:function(e,t,n){},39:function(e,t,n){},40:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(14),o=n.n(c),u=(n(32),n(4)),s=n(16),i=n(2),l=n(20),m=function(e){var t=e.component,n=Object(l.a)(e,["component"]);return r.a.createElement(i.b,Object.assign({},n,{render:function(e){return!1===n.loggedIn?r.a.createElement(i.a,{to:"/session"}):r.a.createElement(t,e)}}))},f=function(e){var t=e.component,n=Object(l.a)(e,["component"]);return r.a.createElement(i.b,Object.assign({},n,{render:function(e){return!0===n.loggedIn?r.a.createElement(i.a,{to:"/"}):r.a.createElement(t,e)}}))},p=n(3),E=n.n(p),d=n(9),b="fruitstand/authentication/token",h=function(e){return{type:"SET_TOKEN",access_token:e}},v=function(e){return{type:"RECEIVE_COMPANY",payload:e}},O=function(e){return{type:"RECEIVE_COMPANIES",companies:e}},g=Object(u.b)((function(e,t){return{companies:Object.values(e.companies),access_token:e.session.access_token}}),(function(e){return{fetchCompanies:function(){return e(function(){var e=Object(d.a)(E.a.mark((function e(t,n){var a,r,c,o,u;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n(),r=a.session.access_token,e.next=3,fetch("".concat("/api","/companies"),{headers:{Authorization:r}});case 3:if(!(c=e.sent).ok){e.next=10;break}return e.next=7,c.json();case 7:o=e.sent,u=o.companies,t(O(u));case 10:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}())}}}))((function(e){var t=e.fetchCompanies,n=e.access_token;Object(a.useEffect)((function(){n&&t()}),[t,n]);var c=e.companies.map((function(t,n){return r.a.createElement("li",{className:"company__item",key:n,onClick:function(){return e.history.push("/companies/".concat(t.id))}},t.name)}));return r.a.createElement("div",null,r.a.createElement("h3",null,"Stores near you:"),r.a.createElement("ul",{className:"company-list"},c))})),j=n(10),y=Object(u.b)(null,(function(e){return{login:function(t,n){return e(function(e,t){return function(){var n=Object(d.a)(E.a.mark((function n(a){var r,c,o;return E.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,fetch("".concat("/api","/session"),{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})});case 2:if(!(r=n.sent).ok){n.next=10;break}return n.next=6,r.json();case 6:return c=n.sent,o=c.access_token,window.localStorage.setItem(b,o),n.abrupt("return",a(h(o)));case 10:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()}(t,n))}}}))((function(e){var t=Object(a.useState)(""),n=Object(j.a)(t,2),c=n[0],o=n[1],u=Object(a.useState)(""),s=Object(j.a)(u,2),i=s[0],l=s[1],m=function(e){("email"===e.target.name?o:l)(e.target.value)};return r.a.createElement("div",{className:"session-form"},r.a.createElement("h1",null,"Login Below"),r.a.createElement("form",{onSubmit:function(t){t.preventDefault(),e.login(c,i)}},r.a.createElement("label",null,"Email"),r.a.createElement("input",{name:"email",value:c,onChange:m}),r.a.createElement("label",null,"Password"),r.a.createElement("input",{name:"password",type:"password",value:i,onChange:m}),r.a.createElement("button",{type:"submit"},"Login")))})),k=function(e){return{type:"RECEIVE_ITEMS",items:e}},I=function(e){return{type:"RECEIVE_ITEM",item:e}},_=Object(u.b)(null,(function(e){return{createItem:function(t,n){return e(function(e,t){return function(){var n=Object(d.a)(E.a.mark((function n(a){var r,c;return E.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,fetch("".concat("/api","/items/").concat(t,"/new"),{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});case 2:return r=n.sent,n.next=5,r.json();case 5:(r=n.sent).ok?(c=r.item,a(I(c))):console.log(r);case 7:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()}(t,n))}}}))((function(e){var t=e.createItem,n=e.companyId,c=e.updateTab,o=e.currentTab,u=Object(a.useState)(""),s=Object(j.a)(u,2),i=s[0],l=s[1],m=Object(a.useState)(""),f=Object(j.a)(m,2),p=f[0],E=f[1],d=Object(a.useState)(""),b=Object(j.a)(d,2),h=b[0],v=b[1],O=function(e){"name"===e.target.name?E(e.target.value):"type"===e.target.name?v(e.target.value):l(e.target.value)};return r.a.createElement("form",{className:"product-form",onSubmit:function(e){e.preventDefault(),t({name:p,imgSrc:i,type:h},n),h!==o&&["fruit","vegetable"].includes(h.toLowerCase())&&c(h),l(""),E(""),v("")}},r.a.createElement("input",{value:p,name:"name",placeholder:"Enter item name...",onChange:O}),r.a.createElement("input",{value:i,name:"imgSrc",placeholder:"Enter item imgSrc...",onChange:O}),r.a.createElement("input",{value:h,name:"type",placeholder:"Enter item type...",onChange:O}),r.a.createElement("button",{type:"submit"},"Add new ".concat(o)))})),w=function(e){var t=e.items.map((function(e){return r.a.createElement("li",{key:e.id,className:"product-list__item"},r.a.createElement("label",null,e.name),r.a.createElement("img",{src:e.imgSrc,alt:e.name}))}));return r.a.createElement("ul",{className:"product-list"},t)},C=Object(i.g)(Object(u.b)((function(e,t){var n=t.match.params.companyId;return{companyId:n,company:e.companies[n],items:Object.values(e.items)||[]}}),(function(e){return{fetchItems:function(t,n){return e(function(e,t){return function(){var n=Object(d.a)(E.a.mark((function n(a){var r,c,o;return E.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,fetch("".concat("/api","/items/").concat(e,"/").concat(t));case 2:if(!(r=n.sent).ok){n.next=9;break}return n.next=6,r.json();case 6:c=n.sent,o=c.items,a(k(o));case 9:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()}(t,n))}}}))((function(e){var t=Object(a.useState)("fruit"),n=Object(j.a)(t,2),c=n[0],o=n[1],u=e.fetchItems,s=e.companyId,i=e.items;return Object(a.useEffect)((function(){u(s,c)}),[c,u,s]),r.a.createElement("section",{className:"product-section"},r.a.createElement("h2",null,c),r.a.createElement("div",{className:"tabs"},r.a.createElement("button",{className:"fruit"===c?"selected":"",name:"fruit",onClick:function(){return o("fruit")}},"Fruit"),r.a.createElement("button",{className:"fruit"===c?"":"selected",name:"Vegetables",onClick:function(){return o("vegetable")}},"Vegetables")),r.a.createElement(w,{items:i}),r.a.createElement(_,{companyId:s,currentTab:c,updateTab:o}))}))),S=Object(u.b)((function(e,t){var n=t.match.params.companyId;return{companyId:n,company:e.companies[n]}}),(function(e){return{fetchCompany:function(t){return e(function(e){return function(){var t=Object(d.a)(E.a.mark((function t(n,a){var r,c,o,u;return E.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=a(),c=r.session.access_token,t.next=3,fetch("".concat("/api","/companies/").concat(e),{headers:{Authorization:c}});case 3:if(!(o=t.sent).ok){t.next=9;break}return t.next=7,o.json();case 7:u=t.sent,n(v(u));case 9:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()}(t))}}}))((function(e){var t=e.fetchCompany,n=e.companyId;return Object(a.useEffect)((function(){t(n)}),[t,n]),e.company?r.a.createElement("div",null,r.a.createElement("h1",null,e.company.name),r.a.createElement(C,null)):null})),x=Object(u.b)(null,(function(e){return{logout:function(){return e(function(){var e=Object(d.a)(E.a.mark((function e(t,n){var a,r;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n(),r=a.session.access_token,e.next=3,fetch("".concat("/api","/session"),{method:"delete",headers:{Authorization:"Bearer ".concat(r)}});case 3:e.sent.ok&&(window.localStorage.removeItem(b),t({type:"REMOVE_TOKEN"}));case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}())}}}))((function(e){return r.a.createElement("nav",{className:"navbar"},r.a.createElement("h1",{onClick:function(){return e.history.push("/")}},"FruitApp"),r.a.createElement("button",{onClick:e.logout},"Logout"))})),N=(n(39),Object(u.b)((function(e){return{access_token:e.session.access_token}}),(function(e){return{loadToken:function(){return e(function(){var e=Object(d.a)(E.a.mark((function e(t){var n;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(n=window.localStorage.getItem(b))&&t(h(n));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}}}))((function(e){var t=e.loadToken;Object(a.useEffect)((function(){t()}),[t]);var n=window.localStorage.getItem(b),c=!!(n||e.access_token);return r.a.createElement(s.a,null,c?r.a.createElement(i.b,{path:"/",component:x}):null,r.a.createElement(i.d,null,r.a.createElement(f,{path:"/session",component:y,loggedIn:c}),r.a.createElement(m,{path:"/companies/:companyId",component:S,loggedIn:c}),r.a.createElement(m,{exact:!0,path:"/",component:g,loggedIn:c})))}))),T=n(11),M=n(26),V={id:null,access_token:null},R=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:V,t=arguments.length>1?arguments[1]:void 0;Object.freeze(e);var n=Object.assign({},e);switch(t.type){case"SET_TOKEN":return Object.assign(n,{access_token:t.access_token});case"REMOVE_TOKEN":return V;default:return e}},A=n(17),L=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;Object.freeze(e);var n=Object.assign({},e);switch(t.type){case"RECEIVE_COMPANY":var a=Object(A.a)({},t.payload.company.id,t.payload.company);return Object.assign(n,a);case"RECEIVE_COMPANIES":var r={};return t.companies.forEach((function(e){return r[e.id]=e})),Object.assign(n,r);default:return e}},P=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;Object.freeze(e);var n=Object.assign({},e),a={};switch(t.type){case"RECEIVE_ITEMS":return t.items.forEach((function(e){return a[e.id]=e})),a;case"RECEIVE_COMPANY":return t.payload.items.forEach((function(e){"fruit"===e.type&&(a[e.id]=e)})),a;case"RECEIVE_ITEM":return Object.assign(n,Object(A.a)({},t.item.id,t.item));default:return e}},z=Object(T.c)({session:R,companies:L,items:P}),D=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||T.d,J=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(T.e)(z,e,D(Object(T.a)(M.a)))}();document.addEventListener("DOMContentLoaded",(function(){o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(u.a,{store:J},r.a.createElement(N,null))),document.getElementById("root"))}))}},[[27,1,2]]]);
//# sourceMappingURL=main.4c8912d2.chunk.js.map